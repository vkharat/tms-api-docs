{
  "components": {
    "schemas": {
      "TrackingInfo": {
        "allOf": [
          {
            "$ref": "./tms-api-spec-common.json#/components/schemas/BaseEntity"
          },
          {
            "type": "object",
            "required": ["currentLocation"],
            "description": "Shipment tracking information",
            "properties": {
              "currentLocation": {
                "$ref": "./tms-api-spec-common.json#/components/schemas/Location"
              },
              "estimatedDelivery": {
                "$ref": "./tms-api-spec-common.json#/components/schemas/DateRange"
              },
              "events": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TrackingEvent"
                }
              },
              "delays": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DelayInfo"
                }
              }
            }
          }
        ]
      },
      "ShipmentStatus": {
        "type": "object",
        "required": ["code", "timestamp"],
        "description": "Current status of the shipment",
        "properties": {
          "code": {
            "type": "string",
            "enum": [
              "BOOKED",
              "PICKED_UP",
              "IN_TRANSIT",
              "CUSTOMS",
              "DELIVERED",
              "EXCEPTION"
            ],
            "description": "Status code"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Status timestamp"
          },
          "details": {
            "type": "string",
            "description": "Additional status details"
          }
        }
      },
      "TrackingEvent": {
        "allOf": [
          {
            "$ref": "./tms-api-spec-common.json#/components/schemas/BaseEntity"
          },
          {
            "type": "object",
            "required": ["eventType", "location"],
            "description": "Tracking event information",
            "properties": {
              "eventType": {
                "type": "string",
                "enum": [
                  "PICKUP",
                  "DEPARTURE",
                  "ARRIVAL",
                  "CUSTOMS_CLEARANCE",
                  "DELIVERY",
                  "EXCEPTION"
                ],
                "description": "Type of event"
              },
              "location": {
                "$ref": "./tms-api-spec-common.json#/components/schemas/Location"
              },
              "description": {
                "type": "string",
                "description": "Event description"
              },
              "documents": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EventDocument"
                }
              }
            }
          }
        ]
      },
      "EventDocument": {
        "type": "object",
        "required": ["type", "url"],
        "description": "Document associated with tracking event",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "POD",
              "CUSTOMS_DECLARATION",
              "INSPECTION_REPORT",
              "EXCEPTION_REPORT"
            ],
            "description": "Document type"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "description": "Document URL"
          },
          "issuedAt": {
            "type": "string",
            "format": "date-time",
            "description": "Document issuance timestamp"
          },
          "expiresAt": {
            "type": "string",
            "format": "date-time",
            "description": "Document expiration timestamp"
          }
        }
      },
      "DelayInfo": {
        "type": "object",
        "required": ["type", "duration"],
        "description": "Delay information",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "WEATHER",
              "CUSTOMS",
              "TECHNICAL",
              "OPERATIONAL",
              "FORCE_MAJEURE"
            ],
            "description": "Type of delay"
          },
          "duration": {
            "$ref": "./tms-api-spec-common.json#/components/schemas/Duration"
          },
          "reason": {
            "type": "string",
            "description": "Detailed reason for delay"
          },
          "impact": {
            "type": "string",
            "enum": ["LOW", "MEDIUM", "HIGH", "SEVERE"],
            "description": "Impact level of delay"
          },
          "resolution": {
            "$ref": "#/components/schemas/DelayResolution"
          }
        }
      },
      "DelayResolution": {
        "type": "object",
        "description": "Resolution information for delay",
        "properties": {
          "action": {
            "type": "string",
            "description": "Action taken to resolve delay"
          },
          "estimatedResolutionTime": {
            "type": "string",
            "format": "date-time",
            "description": "Expected resolution timestamp"
          },
          "status": {
            "type": "string",
            "enum": ["PENDING", "IN_PROGRESS", "RESOLVED", "ESCALATED"],
            "description": "Resolution status"
          }
        }
      }
    }
  }
}